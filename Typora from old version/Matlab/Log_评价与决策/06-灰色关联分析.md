## 灰色关联分析

灰色关联分析主要有两个作用：

1. 进行系统分析，判断影响系统发展的因素的重要性。
2. 用于综合评价问题，给出研究对象或者方案的优劣排名。

灰色关联分析的研究对象往往是一个系统。系统的发展会受到多个因素的影响。我们常常想知道，在众多的影响因素中，哪些是主要因素，哪些是次要因素；哪些因素影响大，哪些因素影响小；哪些具有促进作用，哪些具有抑制作用等等。

数理统计中常常使用回归分析、方差分析、主成分分析等来探究这个问题。但上述的方法有一些共同的不足之处。例如这些方法都要求大量的数据，数据小则结果没有太大意义；有时候还会要求样本服从某个特殊分布，或者出现量化结果与定性分析不符合的情况。而灰色关联分析则可以较好地应对这些问题。

灰色关联分析对样本量的多少和样本有无规律并没有要求（当然样本量也不能太少，就两、三个样本还分析什么），量化结果基本上与定性分析相符合。灰色关联分析的基本思想是，根据序列曲线几何形状的相似程度来判断其联系是否紧密。曲线越接近，相应序列之间的关联度就越大，反之就越小。

### 灰色预测的概念

#### 1.灰色系统、白色系统和黑色系统

- 白色系统表示一个系统的内部特征完全是已知的
- 黑色系统表示一个系统的内部信息对外界屏蔽，只能通过它与外界的联系来观测研究
- 灰色系统内的一部分信息已知，另一部分未知，系统内各因素间有不确定的关系

#### 2.灰色预测的四种常见模型

- 灰色时间序列预测

  用观察到的**反应预测对象特征的时间序列**来构造灰色预测模型，预测未来某一时刻的特征量，或者预测达到某一特征量的时间

- 畸变预测

  通过灰色模型预测异常值出现的时间，预测异常值什么时候出现在特定时区内

- 系统预测

  通过对**系统行为特征指标**建立一组相互关联的灰色预测模型，预测系统中众多变量间的相互协调关系的变化

- 拓扑预测

  将原始数据做曲线，在曲线上按定值寻找该定值发生的所有时点，并以**该定值为框架构成时点数列**，然后建立模型预测该定值所发生的时点

### 灰色关联度与因素分析

系统内的因素往往庞大繁多，需要对系统进行因素分析，这些因素中哪些对系统重要，哪些次要，就需要对系统进行因素分析。

因素分析的基本方法主要有回归分析，但是回归分析也不是万能的，需要大量的数据，而且可能出现反常情况。所以，还可以使用灰色关联度分析的方法来做系统分析。

灰色关联度一定是分析向量与向量之间以及矩阵与矩阵之间的关联度。既然计算关联度，一定是计算某一个带比较的数列与参照物之间的关联程度。

### 计算步骤

**第一步：确定分析数列。**

确定反映系统行为特征的参考数列和影响系统行为的比较数列。反映系统行为特征的数据序列，称为参考数列。影响系统行为的因素组成的数据序列，称比较数列。

设参考数列（又称母序列）为*Y*=*Y*(*k*)∣*k*=1,2...*n*；比较数列（又称子序列）Xi={Xi(k) | *k* = 1,2,Λ,n},i = 1,2,Λ, ... ,m。

<img src="https://img2018.cnblogs.com/blog/819774/201810/819774-20181006164832576-2118444566.png" alt="img" style="zoom:80%;" />

**第二步，变量的无量纲化**

由于系统中各因素列中的数据可能因量纲不同，不便于比较或在比较时难以得到正确的结论。因此在进行灰色关联度分析时，一般都要进行数据的无量纲化处理。

![x_i(k)=\frac{X_i(k)}{X_i(l)},k=1,2,\Lambda,n;i=0,1,2,\Lambda,m](https://wiki.mbalib.com/w/images/math/9/1/7/917b23e6104b154f2a12f834b2db8eca.png)

<img src="https://img2018.cnblogs.com/blog/819774/201810/819774-20181006165602911-1701138151.png" alt="img" style="zoom:80%;" />

**第三步，计算关联系数**

*x*0(*k*)与xi(k)的关联系数

​                    [![Image:灰色关联分析1.jpg](https://wiki.mbalib.com/w/images/5/55/%E7%81%B0%E8%89%B2%E5%85%B3%E8%81%94%E5%88%86%E6%9E%901.jpg)](https://wiki.mbalib.com/wiki/Image:灰色关联分析1.jpg)

记![\triangle_i(k)=|y(k)-x_i(k)|](https://wiki.mbalib.com/w/images/math/a/5/8/a58f2627e69aae661a3642ccaee02151.png)，则

[![Image:灰色关联分析2.jpg](https://wiki.mbalib.com/w/images/9/98/%E7%81%B0%E8%89%B2%E5%85%B3%E8%81%94%E5%88%86%E6%9E%902.jpg)](https://wiki.mbalib.com/wiki/Image:灰色关联分析2.jpg)

![\rho\in(0,\infty)](https://wiki.mbalib.com/w/images/math/9/2/0/920e37892ca7293b3afdf2823ba988fc.png)，称为分辨系数。ρ越小，分辨力越大，一般ρ的取值区间为(0,1),具体取值可视情况而定。当![\rho\le0.5463](https://wiki.mbalib.com/w/images/math/a/f/e/afec12b9b9a58c003e5cf95f71e25062.png)时，分辨力最好，通常取ρ = 0.5。

**第四步，计算关联度**

因为关联系数是比较数列与参考数列在各个时刻（即曲线中的各点）的关联程度值，所以它的数不止一个，而[信息](https://wiki.mbalib.com/wiki/信息)过于分散不便于进行整体性比较。因此有必要将各个时刻（即曲线中的各点）的关联系数集中为一个值，即求其平均值，作为比较数列与参考数列间关联程度的数量表示，关联度*ri*公式如下：

![r_i=\frac{1}{n}\sum_{k=1}^n\xi_i(k),k=1,2,\Lambda,n](https://wiki.mbalib.com/w/images/math/2/4/4/24470aef924c61c7d56e881ebfbd9f03.png)

**第五步，关联度排序**

关联度按大小排序，如果*r*1 < *r*2，则参考数列y与比较数列*x*2更相似。

在算出*X**i*(*k*)序列与Y(k)序列的关联系数后，计算各类关联系数的平均值，平均值*r**i*就称为Y(k)与*X**i*(*k*)的关联度。

### 举例

利用灰色关联分析对6位教师工作状况进行综合分析
1．分析指标包括：专业素质、外语水平、教学工作量、科研成果、论文、著作与出勤．

2．对原始数据经处理后得到以下数值，见下表

 <img src="https://img2018.cnblogs.com/blog/819774/201810/819774-20181006171004323-422739847.png" alt="img" style="zoom: 67%;" />

3．确定参考数据列：

<img src="https://img2018.cnblogs.com/blog/819774/201810/819774-20181006171031974-697206785.png" alt="img" style="zoom: 67%;" />

4．计算 <img src="https://img2018.cnblogs.com/blog/819774/201810/819774-20181006171054812-1323871839.png" alt="img" style="zoom:80%;" />， 见下表

**这里归一化直接使用的减最大值，没有用比值**

 <img src="https://img2018.cnblogs.com/blog/819774/201810/819774-20181006171113201-187527196.png" alt="img" style="zoom: 67%;" />

5.求最值

<img src="https://img2018.cnblogs.com/blog/819774/201810/819774-20181006171141738-1852668889.png" alt="img" style="zoom: 67%;" />

<img src="https://img2018.cnblogs.com/blog/819774/201810/819774-20181006171147853-915150121.png" alt="img" style="zoom: 67%;" />

6．依据（12－5）式，ρ取0.5计算，得

 <img src="https://img2018.cnblogs.com/blog/819774/201810/819774-20181006171243875-1193407553.png" alt="img" style="zoom: 67%;" />

同理得出其它各值，见下表

<img src="https://img2018.cnblogs.com/blog/819774/201810/819774-20181006171254710-486683233.png" alt="img" style="zoom: 67%;" />

7．分别计算每个人各指标关联系数的均值（关联序）:

 <img src="https://img2018.cnblogs.com/blog/819774/201810/819774-20181006171340168-736734190.png" alt="img" style="zoom: 67%;" />

<img src="https://img2018.cnblogs.com/blog/819774/201810/819774-20181006171350012-1823152951.png" alt="img" style="zoom: 67%;" />

8．如果不考虑各指标权重（认为各指标同等重要），六个被评价对象由好到劣依次为1号，5号，3号，6号，2号，4号．

 即<img src="https://img2018.cnblogs.com/blog/819774/201810/819774-20181006171421903-1649658125.png" alt="img" style="zoom: 67%;" />

