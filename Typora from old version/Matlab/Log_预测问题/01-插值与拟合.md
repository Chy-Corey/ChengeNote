## 插值与拟合

### 概述

在处理大量数据时，会用到数据拟合、参数估计、插值等数据处理的算法。此类为题在MATLAB中有现成的函数可以调用。

首先插值和拟合都是根据某个未知函数（或已知但难于求解的函数）的几个已知数据点求出变化规律和特征相似的近似曲线的过程。但是插值法要求的是近似的曲线需要完全经过数据点，而拟合则是得到最接近的结果，强调最小方差的概念。

插值与拟合多用于对问题进行预测，比如我测得了[0,3,6,9,12,15,18,21]八个数据，表示一天里对应时间的人流量。那么我如何预测1点或者8点的人流量呢，此时可以用插值算法或者拟合算法。

#### 联系与区别

- 联系

  都是根据实际中一组数据来预测数据变化规律，构造一个能够反应数据变化规律的近似函数。

- 区别

  插值问题不能得到近似的函数表达式，仅能找到未知点的近似值；拟合可以得到一个近似的映射关系。

### 插值

#### 一维插值函数

##### 内置函数

```matlab
yi = interp1(x, y, xi, 'method');
```

- yi:xi处的插值结果，可以是数组
- x:插值节点，自变量
- y:插值节点，应变量
- xi:待预测点，可以是数组
- 'method':插值方法
  - 'nearest':最邻近插值
  - 'linear':线性插值
  - 'spline':三次样条插值
  -  pchip: 分段3次埃尔米特插值。
  - 'cubic':立方插值
  - 缺省时，默认为分段线性插值

```matlab
% 三次样条插值举例
x = [0,3,5,7,9,11,12,13,14,15];
y = [0,1.2,1.7,2.0,2.1,2.0,1.8,1.2,1.0,1.6];
x1 = 0:0.1:15;
y1 = interp1(x,y,x1,'spline');
plot(x,y,'b-',x1,y1,'r*');
%蓝色实线为插值结果，红色*代表原数据
```

##### Newton插值

这里只介绍牛顿插值，其本质和Lagrange 插值相同，且更简洁。

注意：此函数的x只能是一个数字，不能是数组

实现代码：

```matlab
function [YY,y]=newton_chazhi(X,Y,x,M)
%输入为：X-插值点的x轴向量
%Y-插值点的y轴向量
%需要求解的x变量
%M为多项式次数
%输出YY为差分表
%y是x对应的因变量
  m=length(X);
  YY=zeros(m);
  YY(:,1)=Y;
  %求查分表
  for i=2:m
      for j=i:m
          YY(j,i)=(YY(j,i-1)-YY(j-1,i-1))/(X(j)-X(j-i+1));
      end
  end
  y=Y(1);
  %计算newton插值公式
  for i=1:M
      xl=1;
     for j=1:i
         xl=xl*(x-X(j));
     end
     y=y+xl*YY(i+1,i+1);
  end
end
```

测试函数：

```matlab
function [YY,y]=main()
X=[0.40,0.55,0.65,0.80,0.90,1.05];
Y=[0.41075,0.57815,0.69675,0.88811,1.02652,1.25382];
x=0.596;
M=4;
[YY,y]=newton_chazhi(X,Y,x,M);
end
```

#### 二维插值函数

##### 内置函数

```matlab
z = interp2(x0, y0, z0, x, y, 'method');
```

- z:被插值点的函数值

- x0:插值节点，自变量1(长)

- y0:插值节点，自变量2(宽)

- z0:插值节点，自变量3(高)

- x:被插值点，对应x0

- y:被插值点，对应x1

- 'method':插值方法

  - 'nearest':最近邻插值
  - 'linear':双线性插值
  - 'cubic':双三次插值

  - 缺省时，双线性插值

**注意**：要求x0,y0单调；x和y可取为矩阵，或x行向量，y列向量。x和y的值分别不能超出x0,y0的范围

```matlab
% 双三次插值举例
%	测得平板表面3*5网格点处的温度为：
%	82 81 80 82 84
% 79 63 61 65 81
% 84 84 82 85 86
% 作出平板表面的温度分布曲面图
x = 1:5;
y = 1:3;
temps = [82 81 80 82 84; 79 63 61 65 81; 84 84 82 85 86];
mesh(x, y, temps);
figure(2);
xi = 1:0.2:5;
yi = 1:0.2:3;
zi = interp2(x, y, temps, xi', yi, 'cubic');
mesh(xi, yi, zi);
```

#### 三维插值函数

interp3()我不会

### 拟合

#### 线性最小二乘法

1. 作多项式f(x) =A1*X^m +... + Am\*X  +Am+1拟合，可利用已有程序：

   ```matlab
   a = polyfit(x, y, m);
   % 输入同长度的数组x，y
   % m是拟合多项式的次数
   % a是拟合出来的x和y之间的映射关系
   ```

2. 多项式在x处的值y可用以下命令计算：

   ```matlab
   y = polyval(a, x);
   % x是要计算的点，可以是数组
   ```

#### 指数增长模型

```matlab
y = a*e^bx
% 可变为：lny = lna + b*x
% 这样就可以使用线性最小二乘
```

